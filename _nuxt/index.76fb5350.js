import{_ as ee}from"./nuxt-link.69fc2fdf.js";import{u as te,a as G,b as ae,c as H}from"./menuIsOpenStore.5e7bcf7b.js";import{d as se,u as N,r as $,o as ie,a as ne,c as g,e as S,F as I,g as M,f as B,m as oe,j as y,t as J,q as re,w as le,_ as ue}from"./entry.01c54f3b.js";import{u as de}from"./fromWorksTransitionStore.573937cc.js";import{g as e,C as ce,P as pe,S as me,w as he,b as z,O as F,h as fe,d as ve,i as we,f as ge,e as Se,c as Y,v as ye}from"./webGL.b8c3ad4f.js";import{M as xe}from"./MouseStalker.09d25740.js";e.defaults({ease:ce.easeInOut});class Te{constructor({canvas:o,screen:a,viewport:h,camera:r,plane:i,program:c,texture:v,updateTexturesUniforms:x}){return this.canvas=o,this.screen=a,this.viewport=h,this.camera=r,this.plane=i,this.program=c,this.texture=v,this.textureArray=this.texture.main.concat(this.texture.sub),this.updateTexturesUniforms=x,this.canvasReferenceElement=document.querySelector("[data-js-canvas-slider-size]"),new Promise(f=>{this.resolve=f,this.init()})}init(){this.updateTexturesUniforms(this.texture.sub,null,this.texture.sub.length-1),setTimeout(()=>{this.canvasScaleOut(),this.textureWipeTransition()},1e3)}canvasScaleOut(){this.canvasScaleOutTl=e.timeline({paused:!0,defaults:{duration:13.5}}),this.canvasScaleOutTl.to(this.camera.position,{z:10}),this.canvasScaleOutTl.restart()}textureWipeTransition(){const o=document.querySelector("[data-js-loading-progress]"),a=[...this.textureArray].reverse();this.textureWipeTransitionTL=e.timeline({paused:!0,onStart:()=>{o.setAttribute("aria-hidden",!1)},onUpdate:()=>{this.updateProgress(o)}}),this.textureWipeTransitionTL.to(this.plane.program.uniforms.uProgress,{duration:1.25,value:1,onStart:()=>{},onComplete:()=>{this.updateTexturesUniforms(a,0,null),this.program.uniforms.uCurrentTexture.value=a[0],this.plane.program.uniforms.uProgress.value=0}}),a.forEach((h,r)=>{const i=r,c=r+1,v=i+2===this.textureArray.length;i+1===this.textureArray.length?this.onWipeAnimationComplete():this.textureWipeTransitionTL.to(this.plane.program.uniforms.uProgress,{duration:v?.4:.45-r/20,value:1,onStart:()=>{this.updateTexturesUniforms(a,i,c),this.program.uniforms.uNextTexture.value=a[c]},onComplete:()=>{this.updateTexturesUniforms(a,c,null),this.program.uniforms.uCurrentTexture.value=a[c],this.plane.program.uniforms.uProgress.value=0}},">")}),this.textureWipeTransitionTL.restart()}updateProgress(o){const a=this.textureWipeTransitionTL.progress();o.textContent=Math.floor(a*100)}onWipeAnimationComplete(){const a=()=>{const c=document.querySelector('[data-js-split-text-animation="title"][data-title-number="0"]'),v=c.querySelectorAll('[data-split="char"]'),x=document.querySelectorAll('[data-js-split-text-animation="sitename"] [data-split="char"]'),f=e.timeline({defaults:{duration:1.05},onComplete:()=>{f.kill()},paused:!0});f.to(x,{scaleY:0,y:"-100%",stagger:{amount:.25}}).to(v,{y:0,scaleY:1,stagger:{amount:.85},onComplete:()=>{c.dataset.active=!0}},"<"),f.restart()},h=()=>{e.to(this.plane.scale,{x:this.viewport.width*i.x/this.screen.width,y:this.viewport.height*i.y/this.screen.height,duration:1.05})},r=()=>{e.to(this.camera.position,{delay:.4,duration:1.05,z:1,onStart:()=>{this.canvasScaleOutTl.pause()},onComplete:()=>{this.canvasScaleOutTl.kill(),e.killTweensOf(this.camera.position)}})},i={x:this.canvasReferenceElement.clientWidth,y:this.canvasReferenceElement.clientHeight};this.textureWipeTransitionTL.to(this.plane.program.uniforms.uPlaneSizes.value,{0:i.x,1:i.y,duration:1.05,onStart:()=>{a(),h(),r()},onComplete:()=>{this.onOpeningAnimatiComplete()}},">")}onOpeningAnimatiComplete(){this.textureWipeTransitionTL.kill(),e.killTweensOf([this.plane.program.uniforms.uPlaneSizes.value,this.plane.scale]),this.moveCanvasPosition(),this.resolve()}moveCanvasPosition(o=!0){const a=this.canvasReferenceElement.getBoundingClientRect(),h=-(this.viewport.width/2)+this.plane.scale.x/2+a.left/this.screen.width*this.viewport.width;o?e.to(this.plane.position,{duration:1,delay:.025,x:h}):this.plane.position.x=h}}const _e=["data-is-first-access"],Ae=["data-active"],be={class:"home_siteName","data-js-split-text-animation":"sitename"},ke={"data-split":"wrapper","aria-hidden":"true"},Pe={class:"home_titles","data-js-home-titles":""},Ce=["data-title-number","aria-label","aria-hidden"],Le=["data-title"],Oe="ytng",We=se({__name:"index",setup(K){e.defaults({ease:pe.easeInOut});const{state:o,completeFirstAccessTop:a}=te(),{transitionStore:h,switchPageTransition:r}=G(),{worksStore:i,updateActiveWorkPage:c}=N(),{loadedAnimationStore:v,switchLoadedAnimationState:x}=ae(),{state:f}=H(),l=i.value.activePageIndex,U=o.value.firstAccess,Q=o.value.topFirstAccess,R=$([]),V=$([]),L=i.value.works,O=e.timeline({paused:!0}),X=e.timeline({paused:!0}),k=new me;let T;return f.value.isMenuOpen=!1,ie(()=>{const w=()=>{e.registerPlugin(F),F.create({id:"sliderEventObserver",type:"mousewheel,wheel,touch,pointer",wheelSpeed:-1,onUp:()=>{var n;(n=window.slider)==null||n.transition(1)},onDown:()=>{var n;(n=window.slider)==null||n.transition(-1)},tolerance:10,preventDefault:!0})},W=()=>{e.to(R.value,{duration:2,scaleY:1,y:"0%",stagger:{amount:.2}}),a()},p=()=>{T=new xe,T.addEventListener()},u=()=>{const{lastScrollPosition:n,isAtTopOnPageTransition:s,isAtBottomOnPageTransition:_}=de(),A=n.value.isPageAtBottom,E=()=>{r(!1),d!==null&&(d.dataset.active=!0,d.setAttribute("aria-hidden",!1)),w(),window.navigation.addEventListeners(),window.slider.addEventListeners(),p()},t=(C="down",Z=!0)=>{const j=V.value[l].querySelectorAll('[data-split="char"]');if(!Z){e.set(j,{y:0,scaleY:1,opacity:1});return}const q=document.querySelectorAll('[data-js-loader-title][data-heading="1"] [data-split="wrapper"] [data-split="char"]');q.length!==0&&(e.set(q,{y:0,scaleY:1,opacity:1}),e.to(q,{duration:1,y:C==="up"?"-100%":"100%",scaleY:0,opacity:.5,stagger:{amount:.175}})),O.set('[data-js-slider-nav="wrapper"], .st-footNav_scroll',{opacity:1}).set(j,{y:C==="up"?"100%":"-100%",scaleY:0}).to(j,{duration:1,y:0,scaleY:1,stagger:{amount:.175},onComplete:()=>{r(!1),fe(),ve(),E()}}),C==="up"?z("100%"):C==="down"&&z("-100%"),O.restart()},d=document.querySelector(`[data-title-number="${l}"]`);d==null||d.setAttribute("aria-hidden",!1);const{state:b}=oe(),P=b.value.history,D=P[P.length-2];D==="works"?(window.navigation.onlyVisible(l),window.navigation.width(l,1,!1),window.navigation.resetSlideSize()):(window.navigation.onlyVisible(l,!0),window.navigation.width(l,1,void 0,!1),window.navigation.resetSlideSize()),Q?(A?window.slider.enter(l,!0,!1,!0,!0):window.slider.enter(l,!0,!0),a()):D==="about"?A?window.slider.enter(l,!1,!1,!0,!0):window.slider.enter(l,!1,!0,!0):window.slider.enter(l,!1),document.querySelectorAll('[data-js-loader-title][data-heading="2"] [data-split="wrapper"] [data-split="char"]')!==null&&(A?t("up"):t()),s(!1),_(!1)},m=()=>{document.querySelectorAll('[data-js-slider-nav="number"]').forEach((s,_)=>{_===l?(s.setAttribute("aria-hidden",!1),e.set(s,{y:0})):s.setAttribute("aria-hidden",!0)})};U?((async()=>{const s=await he();window.navigation.createGL(s),W(),await new Te(s),window.slider.init(s),window.navigation.onlyVisible(0),x(!0),window.navigation.width(0),m(),z(),setTimeout(()=>{w(),window.slider.addEventListeners(),window.navigation.addEventListeners(),r(!1),p()},1e3)})(),k.init()):(m(),u())}),ne((w,W,p)=>{const{transitionStore:u}=G();if(u.value.pageTransition){p(!1);return}const{worksStore:m}=N(),n=()=>{r(!0),O.kill(),X.kill();const t=F.getById("sliderEventObserver");t==null||t.disable(),t==null||t.kill(),window.slider.removeEventListeners(),window.navigation.removeEventListeners(),T==null||T.destroy(),k==null||k.destroy()},s=()=>{f.value.isMenuOpen?ge():Se()},_=t=>{if(t===null)return;const{state:d}=H();if(d.value.isMenuOpen)window.slider.hidden();else{window.slider.leave(),ye();const b=t.querySelectorAll('[data-split="char"]');e.set(b,{y:0,scaleY:1,opacity:1})}},A=t=>{if(t===null)return;const d=t.querySelectorAll('[data-split="char"]');e.set(d,{opacity:1,y:0,scale:1}),p()},E=async()=>{const t=document.querySelector('[data-js-loader-title][data-heading="1"] [data-split="wrapper"]');if(t!==null)if(e.killTweensOf('[data-js-loading-progress],[data-js-slider-nav="wrapper"]'),w.meta.page==="about"){const d=document.querySelector('[data-js-loader-title][data-heading="2"] [data-split="wrapper"]'),{worksStore:b}=N(),P=[Y(t,L[b.value.activePageIndex].name),Y(d,"About")];await Promise.all(P),A(t),s()}else w.meta.page==="works"&&(await Y(t,L[m.value.activePageIndex].name),_(t),s(),p())};n(),we()?(s(),window.slider.leave(),e.to(".home_titles",{duration:.25,opacity:0,onComplete:()=>{p()}})):E()}),(w,W)=>{const p=ee;return y(),g("div",{class:"home","data-is-first-access":B(U)},[S("div",{class:"home_hgroup","data-active":B(v).active},[S("div",be,[S("span",ke,[(y(),g(I,null,M(Oe,(u,m)=>S("span",{ref_for:!0,ref_key:"siteNameChars",ref:R,key:m,"data-split":"char"},J(u),1)),64))])]),S("div",Pe,[(y(!0),g(I,null,M(B(L),(u,m)=>(y(),g("h2",{key:u.slug,class:"home_title","data-title-number":m,"data-js-split-text-animation":"title","data-active":"false","aria-label":u.name,"aria-hidden":m!==0},[re(p,{class:"home_titleLink",to:`/works/${u.slug}`,"aria-label":u.name},{default:le(()=>[S("span",{ref_for:!0,ref_key:"splitTextWrapper",ref:V,"data-split":"wrapper","aria-hidden":"true","data-title":u.name},[(y(!0),g(I,null,M(u.name,(n,s)=>(y(),g("span",{key:s,"data-split":"char"},J(n),1))),128))],8,Le)]),_:2},1032,["to","aria-label"])],8,Ce))),128))])],8,Ae)],8,_e)}}});const ze=ue(We,[["__scopeId","data-v-6e70f196"]]);export{ze as default};
